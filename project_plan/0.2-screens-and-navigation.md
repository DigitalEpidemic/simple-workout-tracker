# Phase 0.2: Screens and Navigation Structure

## Navigation Architecture

### Primary Navigation: Bottom Tab Navigator
- **Home Tab** → Home Stack
- **History Tab** → History Stack
- **Analytics Tab** → Analytics Stack
- **Settings Tab** → Settings Stack

---

## Screen Definitions

### 1. Home Screen
**Route**: `Home`
**Stack**: Home Stack (root)

**Responsibilities**:
- Display quick stats (total workouts, current week volume, recent PR)
- Show quick action buttons:
  - "Start Empty Workout"
  - "Choose Template"
- Display recent workout templates (3-5 most recently used)
- Show "Continue Workout" button if a workout is in progress

**Navigation From**:
- Bottom tab (default landing screen)

**Navigation To**:
- Template List (view all templates)
- Template Builder (create new template)
- Start Workout Flow (quick start from template)
- Active Workout (resume or start new)

---

### 2. Template List Screen
**Route**: `TemplateList`
**Stack**: Home Stack

**Responsibilities**:
- Display all saved workout templates
- Search/filter templates
- Show template metadata:
  - Name
  - Number of exercises
  - Estimated duration
  - Last used date
- Swipe actions: Edit, Delete, Duplicate
- "Create New Template" button

**Navigation From**:
- Home Screen

**Navigation To**:
- Template Builder (create new or edit existing)
- Start Workout Flow (select template to begin workout)

---

### 3. Template Builder Screen
**Route**: `TemplateBuilder`
**Stack**: Home Stack
**Params**: `templateId?: string` (optional, for editing)

**Responsibilities**:
- Create or edit workout template
- Set template name
- Add/remove/reorder exercises
- Configure default sets/reps for each exercise
- Save or cancel template
- Exercise library/search integration
- Reorder exercises with drag-and-drop

**Navigation From**:
- Template List (new or edit)
- Home Screen (quick create)

**Navigation To**:
- Template List (on save/cancel)
- Exercise Picker Modal (select exercises)

---

### 4. Start Workout Flow Screen
**Route**: `StartWorkoutFlow`
**Stack**: Home Stack
**Params**: `templateId?: string` (optional)

**Responsibilities**:
- Preview selected template or empty workout
- Show all exercises and planned sets
- Allow last-minute exercise reordering
- "Begin Workout" confirmation button
- Option to modify template before starting

**Navigation From**:
- Home Screen
- Template List

**Navigation To**:
- Active Workout (start session)

---

### 5. Active Workout Screen
**Route**: `ActiveWorkout`
**Stack**: Home Stack (modal or full-screen)
**Params**: `workoutSessionId: string`

**Responsibilities**:
- Display workout session timer (elapsed time)
- Show exercise list with completion status
- Current exercise highlighted
- Show completed sets with checkmarks
- "Add Exercise" button (mid-workout)
- "Finish Workout" button
- "Cancel Workout" option (with confirmation)
- Display rest timer badge when active
- Navigation to each exercise detail

**Navigation From**:
- Start Workout Flow
- Home Screen (resume workout)

**Navigation To**:
- Exercise Detail (tap on exercise)
- Rest Timer Modal (auto-trigger or manual)
- Workout Summary (on completion)
- Home Screen (on cancel, with confirmation)

---

### 6. Exercise Detail Screen
**Route**: `ExerciseDetail`
**Stack**: Home Stack
**Params**: `workoutSessionId: string, exerciseId: string`

**Responsibilities**:
- Display exercise name and instructions (optional)
- Show all sets for this exercise
- Input fields for each set:
  - Weight (lbs/kg)
  - Reps
  - Completed checkbox
- Autofill from previous workout (same exercise)
- Add/remove sets
- Show previous best sets (PR indicator)
- "Done" button to return to Active Workout

**Navigation From**:
- Active Workout Screen

**Navigation To**:
- Active Workout Screen (on done)
- Rest Timer Modal (on set completion)

---

### 7. Rest Timer Modal
**Route**: `RestTimer`
**Type**: Modal
**Params**: `duration: number` (seconds)

**Responsibilities**:
- Display countdown timer
- Show remaining time prominently
- Pause/Resume controls
- "Skip Rest" button
- "Add 15s" / "Add 30s" quick buttons
- Haptic feedback on completion
- Auto-dismiss on completion with option to start next set
- Background timer support

**Navigation From**:
- Active Workout Screen
- Exercise Detail Screen

**Navigation To**:
- Auto-dismiss to previous screen
- Can be dismissed manually

---

### 8. Workout Summary Screen
**Route**: `WorkoutSummary`
**Stack**: Home Stack
**Params**: `workoutSessionId: string`

**Responsibilities**:
- Display completed workout details:
  - Total duration
  - Exercises completed
  - Total sets
  - Total volume (weight × reps)
  - PRs achieved (highlighted)
- Option to add workout notes
- "Save" or "Discard" workout
- Share workout option (future)

**Navigation From**:
- Active Workout Screen (on finish)

**Navigation To**:
- Home Screen (on save)
- History Screen (on save)

---

### 9. History Screen
**Route**: `History`
**Stack**: History Stack (root)

**Responsibilities**:
- List all completed workouts in reverse chronological order
- Group by week/month
- Display summary for each workout:
  - Date and time
  - Template name (if used)
  - Duration
  - Total volume
  - Exercise count
- Filter by date range or exercise
- Search workouts

**Navigation From**:
- Bottom tab

**Navigation To**:
- Workout Detail (view past workout)
- Calendar Screen
- Exercise History

---

### 10. Calendar Screen
**Route**: `Calendar`
**Stack**: History Stack

**Responsibilities**:
- Monthly calendar view
- Highlight days with workouts
- Show workout count per day
- Tap on day to see workouts
- Visualize workout frequency
- Streak tracking
- Month navigation

**Navigation From**:
- History Screen

**Navigation To**:
- Workout Detail (tap on workout)
- History Screen (date filtered)

---

### 11. Exercise History Screen
**Route**: `ExerciseHistory`
**Stack**: History Stack
**Params**: `exerciseName: string`

**Responsibilities**:
- Show all historical data for a specific exercise
- Display sets/reps/weight progression over time
- Show PRs for different rep ranges (1RM, 5RM, 12RM, etc.)
- Timeline of performance
- Volume progression chart
- List all workouts containing this exercise

**Navigation From**:
- History Screen (tap on exercise)
- Analytics Dashboard (tap on exercise chart)

**Navigation To**:
- Workout Detail (tap on specific workout)

---

### 12. Workout Detail Screen
**Route**: `WorkoutDetail`
**Stack**: History Stack
**Params**: `workoutSessionId: string`

**Responsibilities**:
- Display completed workout (read-only)
- Show all exercises and sets
- Display workout notes
- Show PRs achieved
- Total volume and duration
- Option to delete workout
- Option to "Repeat Workout" (create template or start workout)

**Navigation From**:
- History Screen
- Calendar Screen
- Exercise History Screen

**Navigation To**:
- History Screen (back)
- Start Workout Flow (repeat workout)

---

### 13. Analytics Dashboard Screen
**Route**: `Analytics`
**Stack**: Analytics Stack (root)

**Responsibilities**:
- Overview cards:
  - Total workouts (week/month/year/all-time)
  - Total volume
  - Workout frequency
  - Current streak
- Charts:
  - Volume over time (line chart)
  - Workouts per week (bar chart)
  - Top exercises by volume/frequency
- Filter by date range
- PR summary cards (recent PRs)

**Navigation From**:
- Bottom tab

**Navigation To**:
- Exercise Analytics Detail (tap on exercise)
- Exercise History (tap on exercise name)

---

### 14. Exercise Analytics Detail Screen
**Route**: `ExerciseAnalytics`
**Stack**: Analytics Stack
**Params**: `exerciseName: string`

**Responsibilities**:
- Detailed analytics for single exercise
- Weight progression chart
- Volume progression chart
- PR timeline (all rep ranges)
- Frequency (times performed per week/month)
- Personal records table
- Estimated 1RM calculation

**Navigation From**:
- Analytics Dashboard

**Navigation To**:
- Exercise History (view all sets)

---

### 15. Settings Screen
**Route**: `Settings`
**Stack**: Settings Stack (root)

**Responsibilities**:
- App preferences:
  - Weight unit (lbs/kg)
  - Default rest timer duration
  - Theme (light/dark/auto)
  - Haptic feedback toggle
- Data management:
  - Export data (JSON/CSV)
  - Import data
  - Clear all data (with confirmation)
- Sync settings (future):
  - Firebase sync toggle
  - Sync status
  - Manual sync button
- About section:
  - App version
  - Privacy policy
  - Terms of service

**Navigation From**:
- Bottom tab

**Navigation To**:
- N/A (leaf screen)

---

## Navigation Flow Diagram

```
Bottom Tab Navigator
├── Home Tab (Home Stack)
│   ├── Home Screen (root)
│   ├── Template List
│   │   └── Template Builder (create/edit)
│   │       └── Exercise Picker Modal
│   ├── Start Workout Flow
│   │   └── Active Workout
│   │       ├── Exercise Detail
│   │       │   └── Rest Timer Modal
│   │       └── Workout Summary
│   │           └── → Home or History
│   └── Active Workout (resume)
│
├── History Tab (History Stack)
│   ├── History Screen (root)
│   │   ├── Workout Detail
│   │   │   └── Start Workout Flow (repeat)
│   │   └── Exercise History
│   │       └── Workout Detail
│   └── Calendar
│       └── Workout Detail
│
├── Analytics Tab (Analytics Stack)
│   ├── Analytics Dashboard (root)
│   │   ├── Exercise Analytics Detail
│   │   │   └── Exercise History
│   │   └── Exercise History
│   └── PR Timeline (future)
│
└── Settings Tab (Settings Stack)
    └── Settings Screen (root)
        └── Data Management Screens (future)
```

---

## Modal/Overlay Components

### Rest Timer Modal
- Appears over Active Workout or Exercise Detail
- Does not navigate away from current screen
- Dismissible

### Exercise Picker Modal
- Used in Template Builder
- Search and select exercises
- Can be reused in Active Workout ("Add Exercise")

### Confirmation Dialogs
- Cancel Workout (from Active Workout)
- Delete Template
- Delete Workout
- Clear All Data

---

## Navigation Params Summary

| Screen | Params | Required |
|--------|--------|----------|
| Template Builder | `templateId?: string` | No |
| Start Workout Flow | `templateId?: string` | No |
| Active Workout | `workoutSessionId: string` | Yes |
| Exercise Detail | `workoutSessionId: string, exerciseId: string` | Yes |
| Rest Timer | `duration: number` | Yes |
| Workout Summary | `workoutSessionId: string` | Yes |
| Workout Detail | `workoutSessionId: string` | Yes |
| Exercise History | `exerciseName: string` | Yes |
| Exercise Analytics | `exerciseName: string` | Yes |

---

## State Management Considerations

### Global State Needed
- Active workout session (if any)
- Rest timer state (background support)
- User settings (weight unit, default rest, theme)
- Sync status (future)

### Screen-Level State
- Form inputs (Template Builder, Exercise Detail)
- Filter/search states (Template List, History, Analytics)
- Calendar month/year selection

---

## Offline-First Implications

All screens must:
- Work completely offline
- Read from local SQLite database
- Write to SQLite immediately
- Queue sync operations for later (Phase 5)
- Handle no network gracefully
- No loading states for network requests (except sync)

---

## MVP vs Extended Features

### MVP Screens (Required for Phase 1-4)
- Home
- Template List
- Template Builder
- Start Workout Flow
- Active Workout
- Exercise Detail
- Rest Timer Modal
- Workout Summary
- History
- Workout Detail

### Extended Screens (Nice-to-have)
- Calendar
- Exercise History
- Analytics Dashboard
- Exercise Analytics Detail
- Settings (basic version in MVP)

### Future Phase Screens (Phase 5+)
- Sync Settings
- Account/Profile
- Social Features
- Exercise Library Management
