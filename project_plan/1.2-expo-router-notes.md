# Phase 1.2: Expo Router Architecture Notes

## Important Discovery

This project uses **Expo Router** (file-based routing), not traditional React Navigation setup. The expo template already included expo-router with bottom tabs configured.

## Expo Router vs React Navigation

**Expo Router** is built on top of React Navigation but uses file-based routing (like Next.js):
- Routes are defined by file structure in the `app/` directory
- No need to manually configure navigators
- Automatic TypeScript type generation with `typedRoutes: true`
- More modern approach for React Native apps

## Project Structure Adjustment

Instead of implementing navigation in `src/routes/`, we use the existing `app/` directory:

```
app/
├── _layout.tsx                    # Root layout (Stack navigator)
├── (tabs)/                        # Tab group (Bottom tabs)
│   ├── _layout.tsx               # Tab navigator configuration
│   ├── index.tsx                 # Home tab (becomes app/(tabs)/index)
│   ├── history.tsx               # History tab
│   ├── analytics.tsx             # Analytics tab
│   └── settings.tsx              # Settings tab
├── home/                         # Home stack screens
│   ├── template-list.tsx
│   ├── template-builder.tsx
│   ├── start-workout.tsx
│   ├── active-workout.tsx
│   ├── exercise-detail.tsx
│   └── workout-summary.tsx
├── history/                      # History stack screens
│   ├── workout-detail.tsx
│   ├── calendar.tsx
│   └── exercise-history.tsx
├── analytics/                    # Analytics stack screens
│   └── exercise-analytics.tsx
└── rest-timer.tsx                # Modal screen

src/
├── features/                     # Business logic remains here
├── lib/                          # Utilities remain here
└── stores/                       # State management remains here
```

## Navigation Architecture

### File-Based Routing Structure

**Bottom Tabs** (`app/(tabs)/`):
- `index.tsx` → Home tab
- `history.tsx` → History tab
- `analytics.tsx` → Analytics tab
- `settings.tsx` → Settings tab

**Home Stack** (`app/home/`):
- Nested screens accessible via `router.push('/home/template-list')`

**Modals**:
- `app/rest-timer.tsx` → Presented as modal via root `_layout.tsx`

### URL Structure

With Expo Router, routes are URLs:
- `/` or `/(tabs)` → Home tab
- `/(tabs)/history` → History tab
- `/home/template-list` → Template list screen
- `/home/template-builder?templateId=123` → Template builder with ID
- `/rest-timer?duration=90` → Rest timer modal

## Benefits of Expo Router

1. **Type-safe routing** - Auto-generated types for all routes
2. **Deep linking** - Built-in support for URL schemes
3. **Web support** - Works on web without changes
4. **Simpler** - No manual navigator configuration
5. **Modern** - Follows Next.js patterns, familiar to web devs

## Implementation for Phase 1.2

Instead of creating navigators, we:
1. Configure bottom tabs in `app/(tabs)/_layout.tsx`
2. Create tab screens in `app/(tabs)/`
3. Create stack screens in organized folders (`app/home/`, `app/history/`, etc.)
4. Use `router.push()`, `router.back()` for navigation
5. Business logic stays in `src/features/`

## Coexistence with src/ folder

- `app/` - UI routing layer (screens/routes)
- `src/features/` - Business logic (hooks, API, services)
- `src/lib/` - Utilities and database
- `src/stores/` - Global state

Screens in `app/` import from `src/features/` to access business logic.

## Migration Notes

The original plan assumed traditional React Navigation. With Expo Router:
- `src/routes/index.tsx` → Not needed (use `app/_layout.tsx`)
- `src/routes/home.tsx` → Not needed (use `app/(tabs)/index.tsx`)
- Navigation types → Auto-generated by Expo Router

Feature folders in `src/` remain unchanged - only routing changes.
